# Инструкция по внедрению изменений

## Обзор изменений

В рамках данного обновления были внесены следующие изменения:

1. Добавлена связь между пользователями и их документами, задачами и процессами
2. Обновлены модели Django для отражения этих связей
3. Обновлены представления (views) для фильтрации данных по текущему пользователю
4. Обновлены сериализаторы для автоматического присвоения пользователя при создании записей
5. Создана миграция Django для обновления базы данных
6. Создан SQL-скрипт для ручного обновления базы данных (альтернативный вариант)

## Применение изменений

### Вариант 1: Использование миграций Django (рекомендуется)

1. Перейдите в директорию проекта Django:
   ```
   cd e:\DIPLOM\DjVu\dip
   ```

2. Активируйте виртуальное окружение (если используется):
   ```
   ../.venv/Scripts/activate
   ```

3. Примените миграцию:
   ```
   python manage.py migrate
   ```

### Вариант 2: Ручное применение SQL-скрипта

Если по какой-то причине миграции Django не работают, вы можете применить SQL-скрипт напрямую:

1. Подключитесь к вашей базе данных (SQLite, PostgreSQL или другой)
2. Выполните SQL-скрипт из файла `alter_tables.sql`

## Проверка изменений

После применения изменений:

1. Запустите сервер Django:
   ```
   python manage.py runserver
   ```

2. Запустите фронтенд:
   ```
   cd ../front
   npm run serve
   ```

3. Войдите в систему и убедитесь, что:
   - Вы видите только свои документы, задачи и процессы
   - При создании новых записей они автоматически привязываются к вашему аккаунту

## Технические детали

### Изменения в моделях

В моделях `Document`, `Task` и `Process` добавлено поле `user`, которое является внешним ключом на модель `User` из Django. Это позволяет связать каждую запись с конкретным пользователем.

### Изменения в представлениях

Представления (ViewSets) теперь фильтруют данные по текущему пользователю, используя метод `get_queryset()`. Это обеспечивает, что пользователи видят только свои данные.

### Изменения в сериализаторах

Сериализаторы теперь автоматически устанавливают текущего пользователя при создании новых записей, переопределяя метод `create()`.

### Изменения на фронтенде

На фронтенде изменения минимальны, так как фильтрация происходит на стороне сервера на основе токена аутентификации, который передается в заголовке запроса.